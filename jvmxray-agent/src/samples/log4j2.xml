<?xml version="1.0" encoding="UTF-8"?>
<Configuration monitorInterval="0" >

	<!-- TODO: UPDATE WITH YOUR DESIRED SETTINGS. -->
	<Properties>
		<Property name="LOG_HOME">/Users/milton/jvmxray-agent/logs</Property>
		<Property name="MSG_PREAMBLE_SM">%d{YYYY.MM.dd 'at' HH:mm:ss z} | %logger{1} | %X | %5level | %msg%n</Property>
		<Property name="MSG_PREAMBLE_LG">%d{YYYY.MM.dd 'at' HH:mm:ss.SSS z} | %logger | %X | %5level | %msg%n</Property>
		<Property name="MSG_PREAMBLE_MACHINE">%d{ISO8601},%logger,%X{key}{|},%5level,%msg%n</Property>
	</Properties>

	<Appenders>
		<!-- CONSOLE DESTINATION -->
		<Console name="consoledest" target="SYSTEM_OUT">
			<PatternLayout pattern="${MSG_PREAMBLE_SM}" />
		</Console>
		<!-- CSV APPENDER DESTINATION -->
		<Appender type="org.apache.logging.log4j.addons.CsvAppender" name="csvdest" fileName="${LOG_HOME}/jvmxrayagent-events.csv">
		<!-- <Csv name="csvdest" fileName="${LOG_HOME}/jvmxrayagent-events.csv" filePattern="${LOG_HOME}/bkup/jvmxray-agent-%d{yyyy-MM-dd-HH-mm-ss-SSS}-%i.csv"> -->
			<CsvEscape>
				<pattern>${MSG_PREAMBLE_LG}</pattern>
			</CsvEscape>
			<Policies>
				<SizeBasedTriggeringPolicy size="1 MB"/>
			</Policies>
			<DefaultRolloverStrategy max="10"/>
		<!-- </Csv> -->
		</Appender>
		<!-- ROLLINGFILE DESTINATION, USEFUL IN DEBUGGING WHEN YOU NEED MORE INFO THAN CONSOLE PROVIDES. -->
		<RollingFile name="rollingfiledest" fileName="${LOG_HOME}/jvmxrayagent-events.txt"
					 filePattern="${LOG_HOME}/bkup/jvmxray-agent-%d{yyyy-MM-dd-HH-mm-ss-SSS}-%i.log.gz">
			<PatternLayout pattern="${MSG_PREAMBLE_LG}" />
			<Policies>
				<SizeBasedTriggeringPolicy size="50 MB" />
			</Policies>
			<DefaultRolloverStrategy max="10" />
		</RollingFile>
	</Appenders>

	<Loggers>
		<!-- NAMESPACE FOR EVENTS HANDLING. -->
		<Logger name="org.jvmxray.agent.driver.jvmxraysecuritymanager.events" level="warn" additivity="false">
			<AppenderRef ref="consoledest" />
			<AppenderRef ref="csvdest" />
		</Logger>
		<!-- FILE_EXECUTE - If devs executing shell cmd's we want to see max details. -->
		<Logger name="org.jvmxray.agent.driver.jvmxraysecuritymanager.events.fileexecute" level="debug"/>
		<!-- SUPPRESS NOISY PERMISSIONS FOR TESTING PURPOSES. -->
		<Logger name="org.jvmxray.agent.driver.jvmxraysecuritymanager.events.permission" additivity="false" level="OFF"/>
		<Logger name="org.jvmxray.agent.driver.jvmxraysecuritymanager.events.permissionwithcontext" additivity="false" level="OFF"/>
		<!-- ROOT NAMESPACE FOR ANYTHING UNDEFINED.-->
		<Root level="info">
			<AppenderRef ref="consoledest" />
			<AppenderRef ref="csvdest" />
		</Root>
	</Loggers>

</Configuration>
