<?xml version="1.0" encoding="UTF-8"?>
<Configuration monitorInterval="30">

	<!-- TODO: UPDATE WITH YOUR DESIRED SETTINGS. -->
	<Properties>
		<Property name="SLASH">${sys:file.separator}</Property>
		<Property name="ROOT">${SLASH == '/' ? '/' : 'C:\\'}</Property>
		<Property name="LOG_HOME">${ROOT}Users${SLASH}milton${SLASH}jvmxray-agent${SLASH}logs</Property>
		<Property name="MSG_PREAMBLE_SM">%d{HH:mm:ss z} %logger{1} %X %-5level - %msg%n</Property>
		<Property name="MSG_PREAMBLE_LG">%d{HH:mm:ss.SSS z} %logger %X %-5level - %msg%n/</Property>
		<Property name="MSG_PREAMBLE_MACHINE">%d{ISO8601} %logger %X %-5level - %msg%n</Property>
	</Properties>

	<Appenders>
		<!-- CONSOLE DESTINATION -->
		<Console name="consoledest" target="SYSTEM_OUT">
			<PatternLayout pattern="${MSG_PREAMBLE_SM}" />
		</Console>
		<!-- ROLLINGFILE DESTINATION, USEFUL IN DEBUGGING WHEN YOU NEED MORE INFO THAN CONSOLE PROVIDES. -->
		<RollingFile name="rollingfiledest" fileName="${LOG_HOME}/jvmxray-agent.txt"
					 filePattern="${LOG_HOME}${SLASH}bkup${SLASH}jvmxray-agent-%d{MM-dd-yyyy}-%i.log.gz">
			<PatternLayout pattern="${MSG_PREAMBLE_LG}" />
			<Policies>
				<TimeBasedTriggeringPolicy interval="1" modulate="true" />
				<SizeBasedTriggeringPolicy size="50 MB" />
			</Policies>
			<DefaultRolloverStrategy max="10" />
		</RollingFile>
		<!-- JSON DESTINATION FOR MACHINE READABLE EVENT LOGS -->
		<File name="jsondest" fileName="${LOG_HOME}${SLASH}jvmxray-agent.json">
			<JsonLayout timestampFormat="${MSG_PREAMBLE_MACHINE}">
				<JsonProperty name="timestamp" pattern="${MSG_PREAMBLE_MACHINE}" />
				<JacksonJsonFormatter prettyPrint="false" />
			</JsonLayout>
		</File>
	</Appenders>

	<Loggers>
		<!-- NAMESPACE FOR EVENTS HANDLING. -->
		<Logger name="org.jvmxray.agent.driver.jvmxraysecuritymanager.events" level="warn" additivity="false">
			<AppenderRef ref="consoledest" />
			<AppenderRef ref="rollingfiledest" />
			<AppenderRef ref="jsondest" />
		</Logger>
		<!-- SUPRESS NOISY PERMISSIONS FOR THE MOMENT. -->
		<Logger name="org.jvmxray.agent.driver.jvmxraysecuritymanager.events.permission" additivity="false" level="OFF">
			<AppenderRef ref="NO-OP" />
		</Logger>
		<Logger name="org.jvmxray.agent.driver.jvmxraysecuritymanager.events.permissionwithcontext" additivity="false" level="OFF">
			<AppenderRef ref="NO-OP" />
		</Logger>
		<!-- ROOT NAMESPACE FOR ANYTHING UNDEFINED.  NOTE: NO JSON LOGGING. -->
		<Root level="info">
			<AppenderRef ref="consoledest" />
			<AppenderRef ref="rollingfiledest" />
		</Root>
	</Loggers>
</Configuration>
