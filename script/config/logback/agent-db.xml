<?xml version="1.0" encoding="UTF-8"?>
<configuration debug="false" scan="false" scanPeriod="1 minutes">

    <property name="LOG_HOME" value="${jvmxray.agent.logs}" />
    <property name="DB_PATH" value="${jvmxray.test.home}/common/data/jvmxray-test.db" />
    <property name="MSG_FMT_LG" value="C:AP | %d{YYYY.MM.dd 'at' HH:mm:ss z} | %thread | %5level | %logger | %X | %msg%n" />

    <!-- SQLite Database Appender for JVMXRay Events (Shaded version for agent) -->
    <appender name="DATABASE" class="org.jvmxray.agent.log.appender.ShadedSQLiteAppender">
        <databasePath>${DB_PATH}</databasePath>
        <batchSize>50</batchSize>
        <flushIntervalMs>2000</flushIntervalMs>
        <queueSize>5000</queueSize>
    </appender>

    <!-- Console appender for debugging (optional) -->
    <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>${MSG_FMT_LG}</pattern>
        </encoder>
    </appender>

    <!-- Event loggers - all route to database for test data generation -->
    <logger name="org.jvmxray.events.io" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>
    <logger name="org.jvmxray.events.http" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>
    <logger name="org.jvmxray.events.monitor" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>
    <logger name="org.jvmxray.events.sql" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>
    <logger name="org.jvmxray.events.system" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>
    <logger name="org.jvmxray.events.net" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>
    <logger name="org.jvmxray.events.system.uncaughtexception" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>
    <logger name="org.jvmxray.events.crypto" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>
    <logger name="org.jvmxray.events.config" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>
    <logger name="org.jvmxray.events.auth" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>
    <logger name="org.jvmxray.events.serialization" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>
    <logger name="org.jvmxray.events.script" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>
    <logger name="org.jvmxray.events.api" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>
    <logger name="org.jvmxray.events.data" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>
    <logger name="org.jvmxray.events.reflection" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>

    <!-- Catch-all for other jvmxray events -->
    <logger name="org.jvmxray.events" level="DEBUG" additivity="false">
        <appender-ref ref="DATABASE" />
    </logger>

    <!-- Platform logging goes to console only for debugging -->
    <logger name="org.jvmxray" level="INFO" additivity="false">
        <appender-ref ref="CONSOLE" />
    </logger>

    <!-- Root logger - minimal output to avoid noise -->
    <root level="WARN">
        <appender-ref ref="CONSOLE" />
    </root>

</configuration>